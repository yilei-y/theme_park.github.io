---
title: "descriptive part 1"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(plotly)
library(viridis)

knitr::opts_chunk$set(
	echo = TRUE,
	warning = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d

theme_set(theme_minimal() + theme(legend.position = "bottom"))
```


```{r}
theme_park = read_csv("ultimate data.csv") |> 
  janitor::clean_names()
```

```{r worldwide top20 summary}
theme_park  |> 
    filter(
      region != c("Worldwide")
    ) |> 
    group_by(year, type) |> 
    mutate(
      attendance = attendance / 100000
    ) |> 
    summarise(mean = mean(attendance),
              sum = sum(attendance)) |> 
    knitr::kable(digits = 3)
```



```{r}
theme_park |> 
  mutate(
    year = as.factor(year)
  ) |> 
  group_by(year) |> 
  plot_ly(y = ~attendance, color = ~year, type = "box", colors = "viridis")
```



```{r}
 theme_park|> 
  filter(
    region != c("Worldwide")
  ) |> 
  group_by(region, year) |> 
  summarize(attend_sum = mean(attendance)) |> 
  plot_ly(x = ~year, y = ~attend_sum, color = ~region,
          type = "scatter", mode = 'point', colors = "viridis")
```



